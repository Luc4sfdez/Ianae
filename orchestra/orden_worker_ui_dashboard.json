{
  "title": "ORDEN: Implementar Dashboard Web - Orchestra Control Panel",
  "content": "# Implementar Dashboard Web - Orchestra Control Panel\n\n## Contexto\n\nEl sistema orchestra necesita visibilidad para escalar eficientemente. Actualmente no hay forma visual de ver el estado del sistema, documentos pendientes, workers activos, o mÃ©tricas de rendimiento. Esto dificulta la supervisiÃ³n y debugging.\n\n## Objetivo\n\nCrear un dashboard web que muestre en tiempo real el estado completo del sistema orchestra: servicios, workers, documentos, actividad y mÃ©tricas.\n\n## Tareas\n\n### 1. Backend FastAPI (puerto 25501)\n\nCrear aplicaciÃ³n FastAPI en `src/ui/app/main.py` que:\n- Consuma la API de docs-service (localhost:25500)\n- Agregue mÃ©tricas del sistema\n- Sirva pÃ¡ginas HTML estÃ¡ticas\n- Exponga endpoints para AJAX\n\n**Endpoints necesarios:**\n- `GET /` â†’ Dashboard principal\n- `GET /api/status` â†’ Estado de servicios (docs-service, daemon)\n- `GET /api/documents` â†’ Lista de documentos con filtros\n- `GET /api/workers` â†’ Estado de cada worker\n- `GET /api/activity` â†’ Timeline de actividad reciente\n- `GET /api/metrics` â†’ MÃ©tricas agregadas\n\n### 2. Vista Principal - Estado del Sistema\n\n**Elementos a mostrar:**\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  CLAUDE-ORCHESTRA - IANAE               â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  Servicios:                             â”‚\nâ”‚  â— docs-service (25500)  âœ… Online      â”‚\nâ”‚  â— daemon           âœ… Online (2min)    â”‚\nâ”‚                                         â”‚\nâ”‚  API Anthropic: 3/100 llamadas hoy     â”‚\nâ”‚  Costo estimado: $0.06                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**ImplementaciÃ³n:**\n- Verificar conectividad con `curl http://localhost:25500/health`\n- Parsear logs del daemon para extraer mÃ©tricas API\n- Actualizar cada 10 segundos vÃ­a polling AJAX\n\n### 3. Vista de Documentos\n\n**Tabla con columnas:**\n- ID\n- TÃ­tulo (truncado a 50 chars)\n- Autor\n- Estado (pending/in_progress/completed)\n- Prioridad (alta/media/baja)\n- Tags (badges coloreados)\n- Fecha (formato relativo: \"hace 5 min\")\n\n**Funcionalidades:**\n- Filtros por: worker (tags), estado, categorÃ­a\n- BÃºsqueda full-text (usar FTS5 de docs-service)\n- Click en fila â†’ modal con contenido completo en markdown\n- Ordenar por: fecha, prioridad, autor\n\n### 4. Vista por Worker\n\n**Para cada worker mostrar:**\n```\nWORKER-CORE:\nâ”œâ”€ Pendientes: 4\nâ”œâ”€ Ãšltima actividad: hace 5 min\nâ”œâ”€ Reportes publicados: 1\nâ””â”€ Estado: ğŸŸ¢ Activo\n\nWORKER-NLP:\nâ”œâ”€ Pendientes: 0\nâ”œâ”€ Estado: ğŸ”´ Inactivo (sin arrancar)\n\nWORKER-INFRA:\nâ”œâ”€ Pendientes: 0\nâ”œâ”€ Estado: ğŸ”´ Inactivo\n\nWORKER-UI:\nâ”œâ”€ Pendientes: 1 (este dashboard)\nâ”œâ”€ Estado: ğŸŸ¡ Iniciando\n```\n\n**LÃ³gica de estados:**\n- ğŸŸ¢ Activo: tiene actividad en Ãºltimos 15 min\n- ğŸŸ¡ Iniciando: tiene pendientes pero sin actividad reciente\n- ğŸ”´ Inactivo: sin pendientes y sin actividad\n\n### 5. Timeline de Actividad\n\n**Mostrar Ãºltimos 50 eventos:**\n```\n15:54:55  [ORDEN] daemon â†’ worker-core: Implementar optimizaciones numpy\n15:51:23  [REPORTE] worker-core: AnÃ¡lisis completado\n15:48:25  [ORDEN] lucas â†’ worker-core: Analizar nucleo.py\n15:41:08  [RESPUESTA] daemon â†’ worker-core: Sistema OK\n```\n\n**ImplementaciÃ³n:**\n- Consultar `/api/v1/docs?limit=50&sort=created_at:desc`\n- Extraer tipo de documento del tÃ­tulo (ORDEN/REPORTE/DUDA/RESPUESTA)\n- Formatear con colores segÃºn tipo\n- Auto-scroll al nuevo evento\n\n### 6. Vista de MÃ©tricas\n\n**GrÃ¡ficos a implementar:**\n- API calls por hora (grÃ¡fico de lÃ­nea)\n- Tiempo promedio de respuesta del daemon (nÃºmero grande)\n- Documentos por categorÃ­a (pie chart)\n- Workers activos vs inactivos (barra horizontal)\n- Throughput: tareas completadas por dÃ­a (nÃºmero)\n\n**Usar Chart.js o similar para visualizaciones**\n\n## Stack TÃ©cnico\n\n**Backend:**\n- FastAPI 0.104+\n- uvicorn para server\n- requests para llamar a docs-service\n- Python 3.11+\n\n**Frontend:**\n- HTML5 semÃ¡ntico\n- Tailwind CSS (CDN) para estilos\n- JavaScript vanilla (ES6+)\n- Fetch API para AJAX\n- Chart.js (CDN) para grÃ¡ficos\n\n**No usar:**\n- React/Vue/Angular (demasiado complejo para MVP)\n- Webpack/build tools (mantener simple)\n- WebSockets (polling es suficiente para MVP)\n\n## Estructura de Archivos\n\n```\nsrc/ui/\nâ”œâ”€â”€ app/\nâ”‚   â”œâ”€â”€ main.py                 # FastAPI app principal\nâ”‚   â”œâ”€â”€ static/\nâ”‚   â”‚   â”œâ”€â”€ css/\nâ”‚   â”‚   â”‚   â””â”€â”€ dashboard.css   # Estilos custom\nâ”‚   â”‚   â””â”€â”€ js/\nâ”‚   â”‚       â””â”€â”€ dashboard.js    # LÃ³gica del dashboard\nâ”‚   â””â”€â”€ templates/\nâ”‚       â”œâ”€â”€ index.html          # Dashboard principal\nâ”‚       â”œâ”€â”€ documents.html      # Vista documentos (opcional)\nâ”‚       â”œâ”€â”€ workers.html        # Vista workers (opcional)\nâ”‚       â””â”€â”€ activity.html       # Timeline (opcional)\nâ””â”€â”€ requirements.txt            # Dependencias\n```\n\n## ImplementaciÃ³n por Fases\n\n**Fase 1 (MVP - 2 horas):**\n1. FastAPI app bÃ¡sica en puerto 25501\n2. Vista principal con estado de servicios\n3. Lista simple de documentos (sin filtros)\n4. Polling cada 10s\n\n**Fase 2 (Funcionalidad - 2 horas):**\n1. Vista por worker\n2. Timeline de actividad\n3. Filtros y bÃºsqueda en documentos\n4. DiseÃ±o responsive\n\n**Fase 3 (MÃ©tricas - 2 horas):**\n1. GrÃ¡ficos con Chart.js\n2. MÃ©tricas agregadas\n3. Alertas visuales\n4. Optimizaciones de rendimiento\n\n## Criterio de Hecho\n\n- âœ… Dashboard accesible en `http://localhost:25501`\n- âœ… Muestra estado en tiempo real de docs-service y daemon\n- âœ… Lista documentos con datos correctos de la API\n- âœ… Vista por worker funcional\n- âœ… Timeline muestra Ãºltimos eventos\n- âœ… Polling funciona (actualiza cada 10s sin recargar pÃ¡gina)\n- âœ… Responsive (funciona en mÃ³vil)\n- âœ… Sin errores en consola del navegador\n- âœ… CÃ³digo documentado con comentarios\n\n## Restricciones\n\n- NO modificar docs-service (solo consumir su API)\n- NO modificar daemon (solo leer sus logs)\n- Mantener cÃ³digo simple y legible\n- Priorizar funcionalidad sobre diseÃ±o elaborado\n- Usar CDNs para librerÃ­as (no npm/build)\n\n## Comandos de VerificaciÃ³n\n\n**Arrancar dashboard:**\n```bash\ncd E:\\ianae-final\\src\\ui\npython -m uvicorn app.main:app --port 25501 --reload\n```\n\n**Verificar:**\n```bash\ncurl http://localhost:25501/\ncurl http://localhost:25501/api/status\ncurl http://localhost:25501/api/documents\n```\n\n**Logs en tiempo real:**\n```bash\ntype E:\\ianae-final\\orchestra\\daemon\\logs\\arquitecto.log\n```\n\n## Referencias\n\n- docs-service API: `http://localhost:25500/docs`\n- EspecificaciÃ³n completa: `orchestra/PLAN_EJECUCION_BCA.md` secciÃ³n B.1\n- CÃ³digo de docs-service: `orchestra/docs-service/app/main.py`\n- ConfiguraciÃ³n workers: `orchestra.yaml`\n\n## Siguiente Paso\n\nUna vez completado, publicar reporte con:\n- Screenshots del dashboard funcionando\n- URL de acceso\n- Instrucciones de uso\n- Posibles mejoras futuras\n\n## Notas Importantes\n\n1. **Prioridad en funcionalidad**: Es mejor tener un dashboard simple que funcione que uno bonito que no sirva.\n\n2. **Manejo de errores**: Si docs-service no responde, mostrar mensaje claro en lugar de fallar silenciosamente.\n\n3. **Rendimiento**: Con polling cada 10s y ~100 documentos, no deberÃ­a haber problemas. Si crece, optimizar despuÃ©s.\n\n4. **Estado del daemon**: Parsear `arquitecto.log` para saber si estÃ¡ activo (Ãºltima lÃ­nea con timestamp reciente).\n\n5. **Colores sugeridos**:\n   - Verde (#10b981): Activo, completado, success\n   - Amarillo (#f59e0b): En progreso, warning\n   - Rojo (#ef4444): Inactivo, error\n   - Azul (#3b82f6): Info, pendiente\n   - Gris (#6b7280): Neutral, metadata",
  "category": "especificaciones",
  "author": "lucas",
  "tags": ["worker-ui", "fase-b", "dashboard", "prioridad-1"],
  "priority": "alta",
  "status": "completed"
}